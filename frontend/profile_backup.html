<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VitalBites - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        body {
            background: #18181b;
            color: #f3f4f6;
            font-family: 'Segoe UI', 'Roboto', sans-serif;
        }

        /* Enhanced Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #2a2a2a;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff8800, #ff6b35);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #ff6b35, #ff8800);
        }

        /* Dark mode styles matching home page */
        body,
        .bg-gray-50,
        .bg-white {
            background-color: #18181b !important;
            color: #f3f4f6 !important;
        }

        .text-gray-800,
        .text-gray-700,
        .text-gray-600,
        .text-gray-500,
        .text-gray-400,
        .text-gray-900 {
            color: #f3f4f6 !important;
        }

        .container {
            max-width: 980px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .tabs {
            display: flex;
            gap: 16px;
            padding: 22px 32px;
            background: #23232a;
            border-bottom: 2px solid #2d2d36;
            margin-top: 20px;
            border-radius: 16px 16px 0 0;
        }

        .tab-btn {
            background: #23232a;
            color: #ff8800;
            border: 1px solid #2d2d36;
            border-radius: 6px;
            padding: 10px 26px;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        .tab-btn.active,
        .tab-btn:hover {
            background: #ff8800;
            color: #fff;
        }

        .content-area {
            display: flex;
            gap: 32px;
            padding: 32px;
            background: #23232a;
            border-radius: 0 0 16px 16px;
            margin-top: 20px;
        }

        .card {
            background: #23232a;
            border: 1px solid #2d2d36;
            border-radius: 14px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
            padding: 28px 24px;
            flex: 1;
            min-width: 0;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ff8800;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 22px;
        }

        .profile-info {
            display: flex;
            gap: 22px;
            align-items: center;
            margin-bottom: 28px;
        }

        .profile-pic-wrap {
            position: relative;
        }

        .profile-pic {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            border: 3px solid #ff8800;
            object-fit: cover;
        }

        .verified-badge {
            position: absolute;
            bottom: -7px;
            right: -7px;
            background: #22c55e;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 3px solid #23232a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 0.95em;
        }

        .profile-details {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .profile-details .name {
            font-weight: bold;
            font-size: 1.2rem;
            color: #fff;
        }

        .profile-details .email {
            color: #dedede;
        }

        .profile-details .badges {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }

        .badge {
            background: #22c55e;
            color: #23232a;
            font-size: 0.85em;
            border-radius: 12px;
            padding: 2px 12px;
            font-weight: 500;
        }

        .badge.orange {
            background: #ff8800;
            color: #fff;
        }

        .input-row {
            display: flex;
            gap: 16px;
        }

        .input-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin-bottom: 14px;
        }

        .input-group label {
            font-size: 0.95em;
            color: #dedede;
        }

        .input-group input {
            background: #18181b;
            color: #fff;
            border: 1px solid #2d2d36;
            border-radius: 8px;
            padding: 12px;
            font-size: 1em;
        }

        .save-btn {
            background: #ff8800;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 13px 26px;
            font-weight: 500;
            font-size: 1em;
            cursor: pointer;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .save-btn:hover {
            background: #ff6b35;
        }

        .actions-list {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .action-btn {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 8px;
            padding: 16px 22px;
            font-size: 1em;
            font-weight: 500;
            color: #fff;
            border: none;
            cursor: pointer;
            transition: box-shadow 0.2s, transform 0.2s;
            gap: 12px;
        }

        .action-btn .fa-arrow-right {
            font-size: 1.1em;
        }

        .action-btn.orange {
            background: #ff8800;
        }

        .action-btn.blue {
            background: #4f8ef7;
        }

        .action-btn.green {
            background: #22c55e;
        }

        .action-btn.pink {
            background: #f43f5e;
        }

        .action-btn:hover {
            box-shadow: 0 2px 14px rgba(255, 136, 0, 0.10);
            transform: translateY(-2px);
            opacity: 0.97;
        }

        .tab-content {
            width: 100%;
        }

        .orders-filter {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: #18181b;
            color: #ff8800;
            border: 1px solid #2d2d36;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: #ff8800;
            color: #fff;
        }

        .order-item {
            background: #18181b;
            border: 1px solid #2d2d36;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .address-item {
            background: #18181b;
            border: 1px solid #2d2d36;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .favorite-item {
            background: #18181b;
            border: 1px solid #2d2d36;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .favorite-item img {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
        }

        .toggle {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #2d2d36;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: #ff8800;
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        @media (max-width: 900px) {
            .content-area {
                flex-direction: column;
                gap: 20px;
                padding: 16px;
            }
        }

        @media (max-width: 600px) {
            .tabs {
                padding: 14px;
            }

            .content-area {
                padding: 8px;
            }
        }
    </style>
</head>

<body>
    <!-- Header (matches home page) -->
    <header class="bg-gray-900 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Brand Logo -->
                <div class="flex items-center space-x-2">
                    <div>
                        <h1
                            class="text-2xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                            VitalBites
                        </h1>
                        <p class="text-xs text-gray-400 hidden sm:block">Fresh • Fast • Delicious</p>
                    </div>
                </div>

                <!-- Right Navigation -->
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <!-- Home Button -->
                    <button onclick="goHome()"
                        class="flex items-center space-x-2 text-gray-300 hover:text-white transition-all duration-300 p-3 rounded-lg hover:bg-gray-700 bg-gray-800 group">
                        <i class="fas fa-home text-lg group-hover:scale-110 transition-transform"></i>
                        <span class="hidden sm:block font-medium">Home</span>
                    </button>

                    <!-- Logout Button -->
                    <button onclick="logout()"
                        class="flex items-center space-x-2 text-gray-300 hover:text-white transition-all duration-300 p-3 rounded-lg hover:bg-gray-700 bg-gray-800 group">
                        <i class="fas fa-sign-out-alt text-lg group-hover:scale-110 transition-transform"></i>
                        <span class="hidden sm:block font-medium">Logout</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 mt-8">
            <div class="bg-gradient-to-r from-orange-500 to-red-500 rounded-xl p-6 text-white text-center">
                <div class="text-3xl font-bold mb-2" id="total-orders">0</div>
                <div class="text-orange-100 text-sm">Total Orders</div>
            </div>
            <div class="bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl p-6 text-white text-center">
                <div class="text-3xl font-bold mb-2" id="total-spent">₹0</div>
                <div class="text-green-100 text-sm">Total Spent</div>
            </div>
            <div class="bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl p-6 text-white text-center">
                <div class="text-3xl font-bold mb-2" id="saved-addresses">0</div>
                <div class="text-blue-100 text-sm">Saved Addresses</div>
            </div>
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl p-6 text-white text-center">
                <div class="text-3xl font-bold mb-2" id="member-since">2024</div>
                <div class="text-purple-100 text-sm">Member Since</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn active" data-tab="profile-tab"><i class="fas fa-user"></i> Profile</button>
            <button class="tab-btn" data-tab="orders-tab"><i class="fas fa-receipt"></i> Orders</button>
            <button class="tab-btn" data-tab="addresses-tab"><i class="fas fa-map-marker-alt"></i> Addresses</button>
            <button class="tab-btn" data-tab="favorites-tab"><i class="fas fa-heart"></i> Favorites</button>
            <button class="tab-btn" data-tab="settings-tab"><i class="fas fa-cog"></i> Settings</button>
        </div>
        <!-- Main content area -->
        <div class="content-area">
            <!-- Profile Tab -->
            <div id="profile-tab" class="tab-content">
                <!-- Personal Info Card -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-user"></i> Personal Information</div>
                    <div class="profile-info">
                        <div class="profile-pic-wrap">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" class="profile-pic" />
                            <div class="verified-badge"><i class="fas fa-check"></i></div>
                        </div>
                        <div class="profile-details">
                            <span class="name" id="profile-name">John Doe</span>
                            <span class="email" id="profile-email">john.doe@email.com</span>
                            <div class="badges">
                                <span class="badge">Active Member</span>
                                <span class="badge orange">Since 2024</span>
                            </div>
                        </div>
                    </div>
                    <form id="profile-form">
                        <div class="input-row">
                            <div class="input-group">
                                <label for="fullname">Full Name</label>
                                <input type="text" id="fullname" value="John Doe" />
                            </div>
                            <div class="input-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" value="john.doe@email.com" />
                            </div>
                        </div>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="phone">Phone Number</label>
                                <input type="text" id="phone" value="+91 98765 43210" />
                            </div>
                            <div class="input-group">
                                <label for="dob">Date of Birth</label>
                                <input type="date" id="dob" value="1990-01-15" />
                            </div>
                        </div>
                        <button type="submit" class="save-btn">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </form>
                </div>
                <!-- Quick Actions Card -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-bolt"></i> Quick Actions</div>
                    <div class="actions-list">
                        <button class="action-btn orange"
                            onclick="showNotification('Reordering your favorite items...', 'info')">
                            <span><i class="fas fa-shopping-cart"></i> Reorder Favorites</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="action-btn blue"
                            onclick="showNotification('Rewards section coming soon!', 'info')">
                            <span><i class="fas fa-gift"></i> Redeem Rewards</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="action-btn green" onclick="showNotification('Support: +91 98765 43210', 'info')">
                            <span><i class="fas fa-headset"></i> Contact Support</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="action-btn pink"
                            onclick="showNotification('Refer friends and earn rewards!', 'success')">
                            <span><i class="fas fa-share-alt"></i> Refer Friends</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="orders-tab" class="tab-content" style="display: none;">
                <div class="card" style="flex: none; width: 100%;">
                    <div class="card-title"><i class="fas fa-receipt"></i> Order History</div>
                    <div class="orders-filter" style="margin-bottom: 20px;">
                        <button class="filter-btn active" data-filter="all">All Orders</button>
                        <button class="filter-btn" data-filter="delivered">Delivered</button>
                        <button class="filter-btn" data-filter="pending">Pending</button>
                        <button class="filter-btn" data-filter="cancelled">Cancelled</button>
                    </div>
                    <div id="orders-list"></div>
                </div>
            </div>

            <!-- Addresses Tab -->
            <div id="addresses-tab" class="tab-content" style="display: none;">
                <div class="card" style="flex: none; width: 100%;">
                    <div class="card-title">
                        <i class="fas fa-map-marker-alt"></i> Saved Addresses
                        <button class="save-btn" style="margin-left: auto; margin-top: 0;"
                            onclick="toggleAddressForm()">
                            <i class="fas fa-plus"></i> Add New
                        </button>
                    </div>
                    <div id="address-form-container" style="display: none; margin-bottom: 20px;">
                        <form id="address-form"
                            style="background: #18181b; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            <h3 style="color: #ff8800; margin-bottom: 15px;">Add New Address</h3>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="addr-name">Address Label</label>
                                    <input type="text" id="addr-name" placeholder="Home, Office, etc." required />
                                </div>
                                <div class="input-group">
                                    <label for="addr-phone">Contact Number</label>
                                    <input type="text" id="addr-phone" placeholder="+91 98765 43210" required />
                                </div>
                            </div>
                            <div class="input-group">
                                <label for="addr-street">Street Address</label>
                                <input type="text" id="addr-street" placeholder="Street Address" required />
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="addr-city">City</label>
                                    <input type="text" id="addr-city" placeholder="City" required />
                                </div>
                                <div class="input-group">
                                    <label for="addr-state">State</label>
                                    <input type="text" id="addr-state" placeholder="State" required />
                                </div>
                                <div class="input-group">
                                    <label for="addr-pincode">Pincode</label>
                                    <input type="text" id="addr-pincode" placeholder="400001" required />
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button type="submit" class="save-btn">
                                    <i class="fas fa-save"></i> Save Address
                                </button>
                                <button type="button" onclick="toggleAddressForm()"
                                    style="background: #6b7280; border: none; color: white; padding: 13px 26px; border-radius: 8px; cursor: pointer;">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    <div id="addresses-list"></div>
                </div>
            </div>

            <!-- Favorites Tab -->
            <div id="favorites-tab" class="tab-content" style="display: none;">
                <div class="card" style="flex: none; width: 100%;">
                    <div class="card-title"><i class="fas fa-heart"></i> Favorite Items</div>
                    <div id="favorites-list"></div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content" style="display: none;">
                <div class="card" style="flex: none; width: 100%;">
                    <div class="card-title"><i class="fas fa-cog"></i> Settings</div>
                    <div class="settings-section">
                        <h3 style="color: #ff8800; margin-bottom: 15px;">Notification Preferences</h3>
                        <div class="setting-item"
                            style="display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #2d2d36;">
                            <div>
                                <div style="font-weight: 500;">Email Notifications</div>
                                <div style="color: #9ca3af; font-size: 0.9em;">Receive order updates via email</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item"
                            style="display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #2d2d36;">
                            <div>
                                <div style="font-weight: 500;">Push Notifications</div>
                                <div style="color: #9ca3af; font-size: 0.9em;">Get instant updates on your device</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item"
                            style="display: flex; justify-content: space-between; align-items: center; padding: 15px 0;">
                            <div>
                                <div style="font-weight: 500;">Promotional Offers</div>
                                <div style="color: #9ca3af; font-size: 0.9em;">Receive special deals and discounts</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Loading state management
        function showLoadingState(elementId, text = 'Loading...') {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin text-orange-500"></i>
                        <span class="ml-2 text-gray-400">${text}</span>
                    </div>
                `;
            }
        }

        // Tab switching functionality with smooth transitions
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const targetTab = this.dataset.tab;

                // Remove active class from all tabs
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.style.display = 'none';
                    content.style.opacity = '0';
                });

                // Add active class to clicked tab and show content with animation
                this.classList.add('active');
                const targetContent = document.getElementById(targetTab);
                targetContent.style.display = 'block';

                setTimeout(() => {
                    targetContent.style.opacity = '1';
                }, 10);

                showNotification(`Switched to ${this.textContent.trim()}`, 'info');
            });
        });

        // Enhanced sample data with more realistic information
        let userProfile = JSON.parse(localStorage.getItem('userProfile')) ||
            JSON.parse(localStorage.getItem('user') || '{}') ||
            JSON.parse(localStorage.getItem('profile') || '{}');

        // Merge and enhance user data
        if (!userProfile.name || !userProfile.email) {
            userProfile = {
                name: userProfile.name || userProfile.fullName || 'Alex Johnson',
                email: userProfile.email || 'alex.johnson@vitalbites.com',
                phone: userProfile.phone || '+91 9876543210',
                dob: userProfile.dob || '1990-05-15',
                gender: userProfile.gender || 'male',
                joinDate: userProfile.joinDate || '2023-03-15',
                avatar: 'https://randomuser.me/api/portraits/men/32.jpg',
                location: 'Mumbai, Maharashtra'
            };
        }

        let orders = JSON.parse(localStorage.getItem('orders')) || [
            {
                id: '#VB-2024-001',
                date: '2024-01-15T14:30:00',
                status: 'delivered',
                items: ['Margherita Pizza (Large)', 'Chicken Wings (6pc)', 'Coke (500ml)'],
                total: 679,
                restaurant: 'Pizza Corner',
                deliveryTime: '35 mins',
                rating: 4.5
            },
            {
                id: '#VB-2024-002',
                date: '2024-01-20T19:15:00',
                status: 'preparing',
                items: ['Veg Biryani (Full)', 'Raita', 'Pickle'],
                total: 320,
                restaurant: 'Biryani House',
                deliveryTime: '25 mins',
                rating: null
            },
            {
                id: '#VB-2024-003',
                date: '2024-01-22T12:45:00',
                status: 'delivered',
                items: ['Butter Chicken', 'Naan (2pc)', 'Basmati Rice'],
                total: 450,
                restaurant: 'Curry Palace',
                deliveryTime: '40 mins',
                rating: 5.0
            }
        ];

        let addresses = JSON.parse(localStorage.getItem('addresses')) || [
            {
                name: 'Home',
                phone: '+91 9876543210',
                street: '123 Main Street, Apartment 4B',
                city: 'Mumbai',
                state: 'Maharashtra',
                pincode: '400001',
                type: 'home'
            },
            {
                name: 'Office',
                phone: '+91 9876543210',
                street: '456 Business District, Floor 12',
                city: 'Mumbai',
                state: 'Maharashtra',
                pincode: '400070',
                type: 'work'
            }
        ];

        let favorites = JSON.parse(localStorage.getItem('favorites')) || [
            { id: 1, name: "Margherita Pizza", price: 299, image: "https://images.unsplash.com/photo-1604068549290-dea0e4a305ca?w=100&h=100&fit=crop", restaurant: "Pizza Corner", rating: 4.5 },
            { id: 2, name: "Chicken Burger", price: 180, image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=100&h=100&fit=crop", restaurant: "Burger Hub", rating: 4.2 },
            { id: 3, name: "Pasta Carbonara", price: 320, image: "https://images.unsplash.com/photo-1621996346565-e3dbc353d2e5?w=100&h=100&fit=crop", restaurant: "Italian Corner", rating: 4.8 },
            { id: 4, name: "Veg Biryani", price: 220, image: "https://images.unsplash.com/photo-1563379091339-03246963d296?w=100&h=100&fit=crop", restaurant: "Biryani House", rating: 4.3 }
        ];

        // Initialize page with loading states
        document.addEventListener('DOMContentLoaded', function () {
            // Show initial tab
            document.getElementById('profile-tab').style.display = 'block';

            // Show loading for all sections first
            showLoadingState('orders-list', 'Loading orders...');
            showLoadingState('addresses-list', 'Loading addresses...');
            showLoadingState('favorites-list', 'Loading favorites...');

            // Load data with staggered delays for realistic experience
            setTimeout(() => {
                loadUserProfile();
                updateStats();
            }, 300);

            setTimeout(() => {
                renderOrders();
            }, 600);

            setTimeout(() => {
                renderAddresses();
            }, 800);

            setTimeout(() => {
                renderFavorites();
            }, 1000);
        });

        function loadUserProfile() {
            // Update profile display
            document.getElementById('profile-name').textContent = userProfile.name;
            document.getElementById('profile-email').textContent = userProfile.email;

            // Update form fields
            document.getElementById('fullname').value = userProfile.name;
            document.getElementById('email').value = userProfile.email;
            document.getElementById('phone').value = userProfile.phone;
            document.getElementById('dob').value = userProfile.dob;
            document.getElementById('gender').value = userProfile.gender;

            // Update profile image
            const profilePic = document.querySelector('.profile-pic');
            if (profilePic) {
                profilePic.src = userProfile.avatar;
            }
        }

        function updateStats() {
            // Calculate real data
            const orderCount = orders.length;
            const spentAmount = orders.reduce((sum, order) => sum + order.total, 0);
            const addressCount = addresses.length;
            const joinYear = new Date(userProfile.joinDate).getFullYear();

            // Animate counters
            animateCounter(document.getElementById('total-orders'), orderCount);
            animateCounter(document.getElementById('total-spent'), spentAmount, '₹');
            animateCounter(document.getElementById('saved-addresses'), addressCount);
            animateCounter(document.getElementById('member-since'), joinYear);
        }

        function animateCounter(element, target, prefix = '') {
            const start = 0;
            const duration = 1000;
            const startTime = performance.now();

            function updateCounter(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const current = Math.floor(start + (target - start) * progress);

                element.textContent = prefix + current;

                if (progress < 1) {
                    requestAnimationFrame(updateCounter);
                }
            }

            requestAnimationFrame(updateCounter);
        }

        // Enhanced profile form submission
        document.getElementById('profile-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const submitBtn = this.querySelector('.save-btn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
            submitBtn.disabled = true;

            setTimeout(() => {
                const newProfile = {
                    ...userProfile,
                    name: document.getElementById('fullname').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    dob: document.getElementById('dob').value,
                    gender: document.getElementById('gender').value
                };

                // Validate email
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(newProfile.email)) {
                    showNotification('Please enter a valid email address', 'error');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                userProfile = newProfile;
                localStorage.setItem('userProfile', JSON.stringify(userProfile));
                localStorage.setItem('profile', JSON.stringify(userProfile));
                localStorage.setItem('user', JSON.stringify(userProfile));

                loadUserProfile();

                submitBtn.innerHTML = '<i class="fas fa-check"></i> Saved!';
                showNotification('Profile updated successfully!', 'success');

                setTimeout(() => {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }, 2000);
            }, 1000);
        });

        // Enhanced orders functionality
        function renderOrders() {
            const ordersList = document.getElementById('orders-list');

            if (orders.length === 0) {
                ordersList.innerHTML = `
                    <div class="text-center py-8 text-gray-400">
                        <i class="fas fa-receipt text-4xl mb-4"></i>
                        <p>No orders yet. Start ordering your favorite food!</p>
                        <button onclick="goHome()" class="btn btn-primary mt-4">Browse Menu</button>
                    </div>
                `;
                return;
            }

            ordersList.innerHTML = orders.map((order, index) => {
                const orderDate = new Date(order.date);
                const statusColors = {
                    delivered: 'bg-green-500',
                    preparing: 'bg-yellow-500',
                    pending: 'bg-blue-500',
                    cancelled: 'bg-red-500'
                };

                return `
                <div class="order-item" style="animation: slideInUp 0.5s ease ${index * 0.1}s both;">
                    <div class="order-header">
                        <span class="order-id">${order.id}</span>
                        <span class="status ${order.status} ${statusColors[order.status] || 'bg-gray-500'}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
                    </div>
                    <div class="order-details">
                        <div class="order-info">
                            <div class="restaurant"><i class="fas fa-store text-orange-500"></i> ${order.restaurant}</div>
                            <div class="order-date"><i class="fas fa-calendar text-gray-400"></i> ${orderDate.toLocaleDateString()} at ${orderDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                            <div class="order-items"><i class="fas fa-utensils text-gray-400"></i> ${order.items.join(', ')}</div>
                            ${order.deliveryTime ? `<div class="text-sm text-green-500"><i class="fas fa-clock"></i> Delivered in ${order.deliveryTime}</div>` : ''}
                            ${order.rating ? `<div class="text-sm text-yellow-500"><i class="fas fa-star"></i> Rated ${order.rating}/5</div>` : ''}
                        </div>
                        <div class="order-total">₹${order.total}</div>
                    </div>
                    <div class="order-actions">
                        ${order.status !== 'delivered' ?
                        `<button class="btn btn-outline" onclick="trackOrder('${order.id}')"><i class="fas fa-map-marker-alt"></i> Track</button>` :
                        `<button class="btn btn-outline" onclick="viewInvoice('${order.id}')"><i class="fas fa-file-invoice"></i> Invoice</button>`
                    }
                        <button class="btn btn-primary" onclick="reorder('${order.id}')"><i class="fas fa-redo"></i> Reorder</button>
                        ${order.status === 'delivered' && !order.rating ?
                        `<button class="btn btn-secondary" onclick="rateOrder('${order.id}')"><i class="fas fa-star"></i> Rate</button>` : ''
                    }
                    </div>
                </div>
            `;
            }).join('');
        }

        window.trackOrder = function (orderId) {
            showNotification(`Opening live tracking for ${orderId}...`, 'info');
            setTimeout(() => {
                showNotification('Your order is being prepared and will be delivered in 20 minutes!', 'success');
            }, 1500);
        };

        window.viewInvoice = function (orderId) {
            showNotification(`Generating invoice for ${orderId}...`, 'info');
        };

        window.reorder = function (orderId) {
            const order = orders.find(o => o.id === orderId);
            showNotification(`Added ${order.items.length} items to cart from ${order.restaurant}!`, 'success');
        };

        window.rateOrder = function (orderId) {
            const rating = prompt('Rate this order (1-5 stars):');
            if (rating && rating >= 1 && rating <= 5) {
                const orderIndex = orders.findIndex(o => o.id === orderId);
                orders[orderIndex].rating = parseFloat(rating);
                localStorage.setItem('orders', JSON.stringify(orders));
                renderOrders();
                showNotification(`Thank you for rating! You gave ${rating} stars.`, 'success');
            }
        };

        // Enhanced addresses functionality
        function renderAddresses() {
            const addressesList = document.getElementById('addresses-list');

            if (addresses.length === 0) {
                addressesList.innerHTML = `
                    <div class="text-center py-8 text-gray-400">
                        <i class="fas fa-map-marker-alt text-4xl mb-4"></i>
                        <p>No addresses saved yet. Add your first address!</p>
                        <button onclick="toggleAddressForm()" class="btn btn-primary mt-4">Add Address</button>
                    </div>
                `;
                return;
            }

            addressesList.innerHTML = addresses.map((address, index) => {
                const typeIcons = {
                    home: 'fa-home',
                    work: 'fa-building',
                    other: 'fa-map-marker-alt'
                };

                return `
                <div class="address-item" style="animation: slideInUp 0.5s ease ${index * 0.1}s both;">
                    <div class="address-info">
                        <div class="address-name">
                            <i class="fas ${typeIcons[address.type] || typeIcons.other} text-orange-500"></i>
                            ${address.name}
                        </div>
                        <div class="address-details">
                            <div><i class="fas fa-map-marker-alt text-gray-400"></i> ${address.street}</div>
                            <div><i class="fas fa-city text-gray-400"></i> ${address.city}, ${address.state} - ${address.pincode}</div>
                            <div><i class="fas fa-phone text-gray-400"></i> ${address.phone}</div>
                        </div>
                    </div>
                    <div class="address-actions">
                        <button class="btn btn-outline" onclick="editAddress(${index})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteAddress(${index})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

        function toggleAddressForm() {
            const formContainer = document.getElementById('address-form-container');
            const isVisible = formContainer.style.display !== 'none';

            if (isVisible) {
                formContainer.style.opacity = '0';
                setTimeout(() => {
                    formContainer.style.display = 'none';
                }, 300);
            } else {
                formContainer.style.display = 'block';
                setTimeout(() => {
                    formContainer.style.opacity = '1';
                }, 10);
            }
        }

        document.getElementById('address-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
            submitBtn.disabled = true;

            setTimeout(() => {
                const newAddress = {
                    name: document.getElementById('addr-name').value,
                    phone: document.getElementById('addr-phone').value,
                    street: document.getElementById('addr-street').value,
                    city: document.getElementById('addr-city').value,
                    state: document.getElementById('addr-state').value,
                    pincode: document.getElementById('addr-pincode').value,
                    type: 'other'
                };

                addresses.push(newAddress);
                localStorage.setItem('addresses', JSON.stringify(addresses));
                renderAddresses();
                updateStats();
                this.reset();
                toggleAddressForm();

                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                showNotification('Address added successfully!', 'success');
            }, 800);
        });

        window.editAddress = function (index) {
            const address = addresses[index];
            document.getElementById('addr-name').value = address.name;
            document.getElementById('addr-phone').value = address.phone;
            document.getElementById('addr-street').value = address.street;
            document.getElementById('addr-city').value = address.city;
            document.getElementById('addr-state').value = address.state;
            document.getElementById('addr-pincode').value = address.pincode;

            toggleAddressForm();
            showNotification('Edit mode activated. Update the form and submit.', 'info');
        };

        window.deleteAddress = function (index) {
            if (confirm('Are you sure you want to delete this address?')) {
                addresses.splice(index, 1);
                localStorage.setItem('addresses', JSON.stringify(addresses));
                renderAddresses();
                updateStats();
                showNotification('Address deleted successfully!', 'success');
            }
        };

        // Enhanced favorites functionality
        function renderFavorites() {
            const favoritesList = document.getElementById('favorites-list');

            if (favorites.length === 0) {
                favoritesList.innerHTML = `
                    <div class="text-center py-8 text-gray-400">
                        <i class="fas fa-heart text-4xl mb-4"></i>
                        <p>No favorites yet. Add some dishes to your favorites!</p>
                        <button onclick="goHome()" class="btn btn-primary mt-4">Browse Menu</button>
                    </div>
                `;
                return;
            }

            favoritesList.innerHTML = favorites.map((item, index) => `
                <div class="favorite-item" style="animation: slideInUp 0.5s ease ${index * 0.1}s both;">
                    <img src="${item.image}" alt="${item.name}" style="border-radius: 8px;" />
                    <div style="flex: 1;">
                        <div style="font-weight: bold; margin-bottom: 5px;">${item.name}</div>
                        <div style="color: #6b7280; font-size: 0.9em; margin-bottom: 5px;">
                            <i class="fas fa-store"></i> ${item.restaurant}
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #ff8800; font-weight: bold;">₹${item.price}</span>
                            <div style="display: flex; align-items: center; gap: 2px;">
                                <i class="fas fa-star text-yellow-500"></i>
                                <span style="font-size: 0.9em; color: #6b7280;">${item.rating}</span>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="save-btn" style="margin: 0; padding: 8px 12px;" onclick="addToCart(${item.id})">
                            <i class="fas fa-shopping-cart"></i>
                        </button>
                        <button style="background: #ef4444; border: none; color: white; padding: 8px 12px; border-radius: 6px; cursor: pointer;" onclick="removeFromFavorites(${item.id})">
                            <i class="fas fa-heart-broken"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        window.addToCart = function (itemId) {
            const item = favorites.find(f => f.id === itemId);
            showNotification(`${item.name} added to cart!`, 'success');
        };

        window.removeFromFavorites = function (itemId) {
            if (confirm('Remove this item from favorites?')) {
                favorites = favorites.filter(f => f.id !== itemId);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                renderFavorites();
                showNotification('Removed from favorites!', 'info');
            }
        };

        // Enhanced notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                info: 'info-circle',
                warning: 'exclamation-triangle'
            };

            const colors = {
                success: '#22c55e',
                error: '#ef4444',
                info: '#3b82f6',
                warning: '#f59e0b'
            };

            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                padding: 15px 20px;
                border-radius: 12px;
                color: white;
                font-weight: 500;
                transform: translateX(100%);
                transition: all 0.4s ease;
                background: ${colors[type] || colors.info};
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                border-left: 4px solid rgba(255,255,255,0.3);
                max-width: 350px;
            `;

            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-${icons[type] || icons.info}" style="font-size: 1.2em;"></i>
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; cursor: pointer; margin-left: auto; opacity: 0.7;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // Enhanced logout functionality
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                showNotification('Logging out...', 'info');

                setTimeout(() => {
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    showNotification('Logged out successfully! Redirecting...', 'success');

                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1500);
                }, 1000);
            }
        }

        // Add navigation to home page
        function goHome() {
            showNotification('Redirecting to home...', 'info');
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 500);
        }

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .loading-spinner {
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
                color: #6b7280;
            }
            
            .tab-content {
                transition: opacity 0.3s ease;
            }
            
            .order-item, .address-item, .favorite-item {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            
            .order-item:hover, .address-item:hover, .favorite-item:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            }
        `;
        document.head.appendChild(style);
        id: `VB-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`,
            date: getRecentDate(0),
                items: ["Pasta Carbonara", "Garlic Bread"],
                    total: 420,
                        status: "Preparing",
                            customerName: user.name
                },
        {
            id: `VB-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`,
                date: getRecentDate(14),
                    items: ["Chicken Tikka", "Butter Naan", "Rice"],
                        total: 380,
                            status: "Delivered",
                                customerName: user.name
        }
            ];
        localStorage.setItem('orders', JSON.stringify(orders));
        }

        function renderOrders(filter = 'all') {
            const ordersList = document.getElementById('orders-list');
            let filteredOrders = orders;

            if (filter !== 'all') {
                filteredOrders = orders.filter(order => order.status.toLowerCase().includes(filter));
            }

            ordersList.innerHTML = filteredOrders.map(order => `
                <div class="order-item">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <strong>#${order.id}</strong>
                            <span style="color: #9ca3af; margin-left: 10px;">${order.date}</span>
                        </div>
                        <span style="background: ${order.status === 'Delivered' ? '#22c55e' : order.status === 'Preparing' ? '#f59e0b' : '#ef4444'}; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85em;">${order.status}</span>
                    </div>
                    <div style="color: #d1d5db; margin-bottom: 10px;">${order.items.join(', ')}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <strong style="color: #ff8800; font-size: 1.1em;">₹${order.total}</strong>
                        <button class="save-btn" style="margin: 0; padding: 8px 16px;" onclick="showNotification('Reordering...', 'info')">
                            <i class="fas fa-redo"></i> Reorder
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Order filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                renderOrders(this.dataset.filter);
            });
        });

        renderOrders();

        // Addresses functionality - Enhanced with user data
        let addresses = JSON.parse(localStorage.getItem('addresses') || '[]');
        if (!addresses.length) {
            // Generate realistic addresses based on user phone or use defaults
            const userPhone = user.phone || "+91 98765 43210";
            addresses = [
                {
                    name: "Home",
                    phone: userPhone,
                    street: "123 Main Street, Apartment 4B",
                    city: "Mumbai",
                    state: "Maharashtra",
                    pincode: "400001",
                    isDefault: true
                },
                {
                    name: "Office",
                    phone: userPhone,
                    street: "456 Business District, Tower A",
                    city: "Mumbai",
                    state: "Maharashtra",
                    pincode: "400070",
                    isDefault: false
                }
            ];
            localStorage.setItem('addresses', JSON.stringify(addresses));
        }

        function renderAddresses() {
            const addressesList = document.getElementById('addresses-list');
            addressesList.innerHTML = addresses.map((addr, index) => `
                <div class="address-item">
                    <div>
                        <div style="font-weight: bold; color: #ff8800; margin-bottom: 5px;">${addr.name}</div>
                        <div style="margin-bottom: 3px;">${addr.street}</div>
                        <div style="color: #9ca3af;">${addr.city}, ${addr.state} - ${addr.pincode}</div>
                        <div style="color: #9ca3af; font-size: 0.9em;"><i class="fas fa-phone"></i> ${addr.phone}</div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="save-btn" style="margin: 0; padding: 8px 12px;" onclick="deleteAddress(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

    </script>
</body>

</html>