<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VitalBites - Food Delivery App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Enhanced Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #2a2a2a;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff8800, #ff6b35);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #ff6b35, #ff8800);
        }

        /* Simplified animation for food cards */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .food-card {
            animation: fadeInUp 0.3s ease-out forwards;
            animation-delay: calc(var(--order) * 0.05s);
            transition: all 0.2s ease;
        }

        .food-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(255, 136, 0, 0.2);
        }

        /* Simplified pulse animation for cart button */
        @keyframes pulseOrange {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.02);
            }

            100% {
                transform: scale(1);
            }
        }

        .pulse {
            animation: pulseOrange 2s infinite;
        }

        /* Simplified floating animation */
        @keyframes floatingSmooth {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        .floating {
            animation: floatingSmooth 6s ease-in-out infinite;
        }

        /* Simplified bounce animation */
        @keyframes springBounce {
            0% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-8px);
            }

            100% {
                transform: translateY(0);
            }
        }

        .bounce:hover {
            animation: springBounce 0.3s ease-out;
        }

        /* Simplified restaurant card hover */
        .restaurant-card {
            transition: all 0.2s ease;
        }

        .restaurant-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(255, 136, 0, 0.15);
        }

        /* Simplified cart dropdown animation */
        @keyframes slideDown {
            0% {
                opacity: 0;
                transform: translateY(-15px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .cart-dropdown {
            animation: slideDown 0.2s ease-out forwards;
        }

        /* Simplified add to cart button animation */
        @keyframes addToCartSuccess {
            0% {
                background: linear-gradient(45deg, #f97316, #ea580c);
            }

            50% {
                background: linear-gradient(45deg, #22c55e, #16a34a);
            }

            100% {
                background: linear-gradient(45deg, #f97316, #ea580c);
            }
        }

        .add-to-cart-animate {
            animation: addToCartSuccess 0.4s ease;
        }

        /* Scale animation for quantity buttons */
        .scale-110 {
            transform: scale(1.1);
            transition: transform 0.15s ease;
        }

        /* Enhanced heart filling animation */
        @keyframes heartBeat {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.15);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes heartFill {
            0% {
                transform: scale(1);
                color: #9ca3af;
            }
            
            25% {
                transform: scale(1.1);
                color: #fbbf24;
            }
            
            50% {
                transform: scale(1.2);
                color: #f59e0b;
            }
            
            75% {
                transform: scale(1.15);
                color: #f97316;
            }

            100% {
                transform: scale(1);
                color: #ef4444;
            }
        }

        @keyframes heartEmpty {
            0% {
                transform: scale(1);
                color: #ef4444;
            }
            
            50% {
                transform: scale(0.9);
                color: #9ca3af;
            }

            100% {
                transform: scale(1);
                color: #9ca3af;
            }
        }

        .heart-animate {
            animation: heartBeat 0.3s ease;
        }

        .heart-fill {
            animation: heartFill 0.5s ease;
        }

        .heart-empty {
            animation: heartEmpty 0.3s ease;
        }

        /* Heart with gradient colors for different levels */
        .heart-level-1 {
            color: #fbbf24 !important; /* Yellow */
        }

        .heart-level-2 {
            color: #f59e0b !important; /* Orange */
        }

        .heart-level-3 {
            color: #f97316 !important; /* Deep Orange */
        }

        .heart-level-4 {
            color: #ef4444 !important; /* Red */
        }

        /* Ensure favorite button is clickable */
        .favorite-btn {
            position: relative;
            z-index: 10;
            cursor: pointer !important;
            pointer-events: auto !important;
            min-width: 44px;
            min-height: 44px;
            display: flex !important;
            align-items: center;
            justify-content: center;
        }

        .favorite-btn:hover {
            transform: scale(1.1);
            background-color: rgba(255, 255, 255, 1) !important;
        }

        .favorite-btn i {
            pointer-events: none;
            font-size: 18px;
        }

        /* Enable dark mode for the entire page */

        body,
        .bg-gray-50,
        .bg-white {
            background-color: #18181b !important;
            color: #f3f4f6 !important;
        }

        .text-gray-800,
        .text-gray-700,
        .text-gray-600,
        .text-gray-500,
        .text-gray-400,
        .text-gray-900 {
            color: #f3f4f6 !important;
        }

        .bg-white,
        .bg-gray-100,
        .bg-orange-100 {
            background-color: #23232a !important;
        }

        .border-gray-200,
        .border-gray-100,
        .border-orange-200,
        .border-gray-300,
        .border-gray-700 {
            border-color: #2d2d36 !important;
        }

        .shadow-md,
        .shadow-lg,
        .shadow-xl {
            box-shadow: 0 4px 24px 0 rgba(0, 0, 0, 0.7) !important;
        }

        .rounded-full,
        .rounded-lg,
        .rounded-xl {
            background-clip: padding-box;
        }

        .hover\:bg-gray-100:hover,
        .hover\:bg-gray-300:hover,
        .hover\:bg-gray-900:hover {
            background-color: #23232a !important;
        }

        .bg-orange-500,
        .hover\:bg-orange-500:hover,
        .hover\:bg-orange-600:hover,
        .bg-orange-600 {
            background-color: #ff8800 !important;
        }

        .text-orange-500 {
            color: #ff8800 !important;
        }

        .bg-gray-200 {
            background-color: #23232a !important;
        }

        .bg-gray-800 {
            background-color: #18181b !important;
        }

        .bg-black {
            background-color: #101014 !important;
        }

        .text-white {
            color: #f3f4f6 !important;
        }

        .text-red-500 {
            color: #ff4d4f !important;
        }

        .bg-gray-900,
        .hover\:bg-gray-800:hover {
            background-color: #101014 !important;
        }

        input,
        textarea,
        select {
            background-color: #23232a !important;
            color: #f3f4f6 !important;
            border-color: #2d2d36 !important;
        }

        /* Scrollbar dark */
        ::-webkit-scrollbar {
            background: #23232a;
        }

        ::-webkit-scrollbar-thumb {
            background: #444;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        /* Simplified waterfall animation for brand name */
        .waterfall-brand span {
            display: inline-block;
            opacity: 0;
            animation: waterfall-fall 0.3s forwards;
        }

        .waterfall-brand span:nth-child(1) {
            animation-delay: 0.1s;
        }

        .waterfall-brand span:nth-child(2) {
            animation-delay: 0.15s;
        }

        .waterfall-brand span:nth-child(3) {
            animation-delay: 0.2s;
        }

        .waterfall-brand span:nth-child(4) {
            animation-delay: 0.25s;
        }

        .waterfall-brand span:nth-child(5) {
            animation-delay: 0.3s;
        }

        .waterfall-brand span:nth-child(6) {
            animation-delay: 0.35s;
        }

        .waterfall-brand span:nth-child(7) {
            animation-delay: 0.4s;
        }

        .waterfall-brand span:nth-child(8) {
            animation-delay: 0.45s;
        }

        .waterfall-brand span:nth-child(9) {
            animation-delay: 0.5s;
        }

        .waterfall-brand span:nth-child(10) {
            animation-delay: 0.55s;
        }

        @keyframes waterfall-fall {
            to {
                opacity: 1;
            }
        }

        /* Simplified flying heart animation */
        .flying-heart {
            position: absolute;
            pointer-events: none;
            z-index: 50;
            font-size: 1.5rem;
            color: #ff4d4f;
            animation: flyHeart 1s ease-out forwards;
        }

        @keyframes flyHeart {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateY(-60px) scale(0.8);
            }
        }

        /* Simplified mobile animations */
        @media (max-width: 768px) {

            .food-card:hover,
            .food-card:active {
                transform: translateY(-2px);
                box-shadow: 0 6px 15px rgba(255, 136, 0, 0.15);
            }

            .restaurant-card:hover,
            .restaurant-card:active {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(255, 136, 0, 0.1);
            }

            .flying-heart {
                font-size: 1.2rem;
            }

            .bounce:hover {
                animation: springBounce 0.2s ease-out;
            }

            .floating {
                animation: floatingSmooth 8s ease-in-out infinite;
            }
        }

        /* Simplified page transitions */
        .page-transition {
            opacity: 0;
            transform: translateY(10px);
            animation: fadeIn 0.3s ease-out forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Simplified notification animation */
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        .alert-enter {
            animation: slideInRight 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .alert-exit {
            animation: slideOutRight 0.3s ease-in;
        }

        /* Enhanced button hover effects */
        .btn-primary {
            position: relative;
            background: linear-gradient(45deg, #f97316, #ea580c);
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(249, 115, 22, 0.3);
        }

        /* Enhanced category cards */
        .category-card {
            position: relative;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent 40%, rgba(255, 255, 255, 0.1) 50%, transparent 60%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .category-card:hover::before {
            opacity: 1;
        }

        /* Staggered animations for categories */
        .category-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .category-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .category-card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .category-card:nth-child(4) {
            animation-delay: 0.4s;
        }

        .category-card:nth-child(5) {
            animation-delay: 0.5s;
        }

        .category-card:nth-child(6) {
            animation-delay: 0.6s;
        }

        /* Text clamp utilities */
        .line-clamp-1 {
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            line-clamp: 1;
            -webkit-box-orient: vertical;
        }

        .line-clamp-2 {
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <!-- Header -->
    <header class="bg-gray-900 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Brand Logo -->
                <div class="flex items-center space-x-2">
                    <div>
                        <h1
                            class="text-2xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                            VitalBites
                        </h1>
                        <p class="text-xs text-gray-400 hidden sm:block">Fresh ‚Ä¢ Fast ‚Ä¢ Delicious</p>
                    </div>
                </div>

                <!-- Right Navigation -->
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <!-- Notifications (for logged in users) -->
                    <div id="notifications-container" class="hidden relative">
                        <button
                            class="relative p-3 text-gray-300 hover:text-white transition-all duration-300 bg-gray-800 hover:bg-gray-700 rounded-lg group">
                            <i class="fas fa-bell text-lg group-hover:scale-110 transition-transform"></i>
                            <span
                                class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse">3</span>
                        </button>
                    </div>

                    <!-- Cart -->
                    <div class="relative">
                        <button id="cart-btn"
                            class="relative p-3 text-gray-300 hover:text-white transition-all duration-300 bg-gray-800 hover:bg-gray-700 rounded-lg group">
                            <i class="fas fa-shopping-cart text-lg group-hover:scale-110 transition-transform"></i>
                            <span id="cart-count"
                                class="absolute -top-1 -right-1 bg-orange-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium transition-all">0</span>
                        </button>

                        <!-- Enhanced Cart Dropdown -->
                        <div id="cart-dropdown"
                            class="hidden absolute right-0 mt-2 w-80 sm:w-96 bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden z-50 cart-dropdown">
                            <div class="bg-gradient-to-r from-orange-500 to-red-500 px-4 sm:px-6 py-4">
                                <h3 class="font-bold text-white text-lg flex items-center">
                                    <i class="fas fa-shopping-bag mr-3 text-xl"></i>
                                    Your Order
                                </h3>
                            </div>
                            <div id="cart-items" class="max-h-64 overflow-y-auto">
                                <div class="p-6 text-center text-gray-500">
                                    <i class="fas fa-shopping-cart text-5xl mb-4 text-gray-300"></i>
                                    <p class="text-lg font-medium mb-1">Your cart is empty</p>
                                    <p class="text-sm">Add delicious items to get started!</p>
                                </div>
                            </div>
                            <div class="px-4 sm:px-6 py-4 border-t border-gray-100 bg-gray-50">
                                <div class="flex justify-between items-center mb-4">
                                    <span class="font-semibold text-gray-700 text-lg">Total:</span>
                                    <span id="cart-total" class="font-bold text-2xl text-gray-900">‚Çπ0.00</span>
                                </div>
                                <button
                                    class="w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 checkout-btn flex items-center justify-center">
                                    <i class="fas fa-credit-card mr-3 text-lg"></i>
                                    Proceed to Checkout
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Profile/Login Button -->
                    <div id="profile-icon-container" class="relative">
                        <button id="profile-btn"
                            class="relative p-3 text-gray-300 hover:text-white transition-all duration-300 bg-gray-800 hover:bg-gray-700 rounded-lg group">
                            <i class="fas fa-user text-lg group-hover:scale-110 transition-transform"></i>
                        </button>
                    </div>
                </div>
            </div>
    </header>

    <!-- Enhanced Welcome Banner -->
    <section id="welcome-banner"
        class="bg-gradient-to-br from-orange-500 via-red-500 to-pink-500 text-white py-20 px-4 relative overflow-hidden">
        <div class="absolute inset-0 bg-black bg-opacity-20"></div>

        <div class="relative max-w-7xl mx-auto text-center">
            <div class="page-transition">
                <h1 class="text-4xl md:text-6xl font-bold mb-6 leading-tight">
                    Welcome to <span class="text-yellow-300 drop-shadow-lg">VitalBites</span>
                </h1>
                <p class="text-xl md:text-2xl mb-8 text-orange-100 max-w-3xl mx-auto leading-relaxed">
                    Delicious food delivered to your doorstep in minutes ‚ö°
                </p>
                <div id="cta-container" class="space-y-6">
                    <!-- For logged in users -->
                    <div id="user-cta" class="hidden space-y-6">
                        <h2 class="text-2xl md:text-3xl mb-6">
                            <span id="welcome-user-name" class="drop-shadow-lg">Welcome back, User!</span> üçΩÔ∏è
                        </h2>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Enhanced Categories -->
        <section class="mb-12 page-transition">
            <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">
                <span class="bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent">
                    Browse Categories
                </span>
            </h2>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
                <div
                    class="category-card bg-white rounded-2xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-500 cursor-pointer bounce group transform hover:-translate-y-2">
                    <div
                        class="bg-gradient-to-br from-orange-100 to-orange-200 w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i
                            class="fas fa-hamburger text-3xl text-orange-500 group-hover:rotate-12 transition-transform duration-300"></i>
                    </div>
                    <span
                        class="font-semibold text-gray-700 group-hover:text-orange-600 transition-colors">Burgers</span>
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300">
                    </div>
                </div>
                <div
                    class="category-card bg-white rounded-2xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-500 cursor-pointer bounce group transform hover:-translate-y-2">
                    <div
                        class="bg-gradient-to-br from-red-100 to-red-200 w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i
                            class="fas fa-pizza-slice text-3xl text-red-500 group-hover:rotate-12 transition-transform duration-300"></i>
                    </div>
                    <span class="font-semibold text-gray-700 group-hover:text-red-600 transition-colors">Pizza</span>
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-red-500 to-orange-500 rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300">
                    </div>
                </div>
                <div
                    class="category-card bg-white rounded-2xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-500 cursor-pointer bounce group transform hover:-translate-y-2">
                    <div
                        class="bg-gradient-to-br from-yellow-100 to-yellow-200 w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i
                            class="fas fa-drumstick-bite text-3xl text-yellow-600 group-hover:rotate-12 transition-transform duration-300"></i>
                    </div>
                    <span
                        class="font-semibold text-gray-700 group-hover:text-yellow-700 transition-colors">Chicken</span>
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300">
                    </div>
                </div>
                <div
                    class="category-card bg-white rounded-2xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-500 cursor-pointer bounce group transform hover:-translate-y-2">
                    <div
                        class="bg-gradient-to-br from-blue-100 to-blue-200 w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i
                            class="fas fa-fish text-3xl text-blue-500 group-hover:rotate-12 transition-transform duration-300"></i>
                    </div>
                    <span class="font-semibold text-gray-700 group-hover:text-blue-600 transition-colors">Seafood</span>
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300">
                    </div>
                </div>
                <div
                    class="category-card bg-white rounded-2xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-500 cursor-pointer bounce group transform hover:-translate-y-2">
                    <div
                        class="bg-gradient-to-br from-pink-100 to-pink-200 w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i
                            class="fas fa-ice-cream text-3xl text-pink-500 group-hover:rotate-12 transition-transform duration-300"></i>
                    </div>
                    <span
                        class="font-semibold text-gray-700 group-hover:text-pink-600 transition-colors">Desserts</span>
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-pink-500 to-purple-500 rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300">
                    </div>
                </div>
                <div
                    class="category-card bg-white rounded-2xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-500 cursor-pointer bounce group transform hover:-translate-y-2">
                    <div
                        class="bg-gradient-to-br from-green-100 to-green-200 w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i
                            class="fas fa-coffee text-3xl text-green-600 group-hover:rotate-12 transition-transform duration-300"></i>
                    </div>
                    <span class="font-semibold text-gray-700 group-hover:text-green-700 transition-colors">Drinks</span>
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-green-500 to-teal-500 rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300">
                    </div>
                </div>
            </div>
        </section>

        <!-- Featured Menu Items -->
        <section id="food-section">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">Menu Items</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" id="food-items">
                <!-- Food items will be added dynamically with JavaScript -->
            </div>
        </section>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-50">
        <div class="bg-white p-6 rounded shadow-md w-80">
            <h2 class="text-xl mb-4">Login</h2>
            <input id="loginEmail" type="email" placeholder="Email" class="w-full mb-2 p-2 border rounded" />
            <input id="loginPassword" type="password" placeholder="Password" class="w-full mb-4 p-2 border rounded" />
            <button onclick="login()" class="bg-blue-500 text-white px-4 py-2 rounded w-full">Login</button>
            <p class="mt-2 text-sm">No account? <a href="#" onclick="showRegister()">Register</a></p>
            <button onclick="closeModal('loginModal')" class="absolute top-2 right-2 text-gray-500">&times;</button>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-50">
        <div class="bg-white p-6 rounded shadow-md w-80">
            <h2 class="text-xl mb-4">Register</h2>
            <input id="registerUsername" type="text" placeholder="Username" class="w-full mb-2 p-2 border rounded" />
            <input id="registerEmail" type="email" placeholder="Email" class="w-full mb-2 p-2 border rounded" />
            <input id="registerPassword" type="password" placeholder="Password"
                class="w-full mb-4 p-2 border rounded" />
            <button onclick="register()" class="bg-green-500 text-white px-4 py-2 rounded w-full">Register</button>
            <p class="mt-2 text-sm">Already have an account? <a href="#" onclick="showLogin()">Login</a></p>
            <button onclick="closeModal('registerModal')" class="absolute top-2 right-2 text-gray-500">&times;</button>
        </div>
    </div>

    <!-- Cart Popup -->
    <div id="cart-popup" class="fixed top-16 right-4 bg-[#23232a] rounded-xl shadow-2xl w-80 p-6 z-50 hidden">
        <!-- Cart content -->
    </div>

    <!-- Add this modal for new user details -->
    <div id="detailsModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-50">
        <div class="bg-white p-6 rounded shadow-md w-80">
            <h2 class="text-xl mb-4">Complete Registration</h2>
            <input id="newUsername" type="text" placeholder="Username" class="w-full mb-2 p-2 border rounded" />
            <input id="newMobile" type="text" placeholder="Mobile Number" class="w-full mb-4 p-2 border rounded" />
            <button onclick="completeRegistration()"
                class="bg-green-500 text-white px-4 py-2 rounded w-full">Submit</button>
            <button onclick="closeModal('detailsModal')" class="absolute top-2 right-2 text-gray-500">&times;</button>
        </div>
    </div>

    <script src="js/cart-sync.js"></script>
    <script>
        // Add CSS for better animations
        const style = document.createElement('style');
        style.textContent = `
            .scale-110 {
                transform: scale(1.1);
                transition: transform 0.15s ease-in-out;
            }
            
            .pulse {
                animation: pulse 0.5s ease-in-out;
            }
            
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }
            
            .add-to-cart-animate {
                animation: addToCartBounce 0.5s ease-in-out;
            }
            
            @keyframes addToCartBounce {
                0%, 100% { transform: scale(1); }
                25% { transform: scale(0.95); }
                50% { transform: scale(1.05); }
                75% { transform: scale(0.98); }
            }
            
            .heart-animate {
                animation: heartBeat 0.3s ease-in-out;
            }
            
            @keyframes heartBeat {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.2); }
            }
            
            .flying-heart {
                position: absolute;
                color: #ef4444;
                font-size: 20px;
                pointer-events: none;
                animation: flyHeart 1s ease-out forwards;
                z-index: 9999;
            }
            
            @keyframes flyHeart {
                0% {
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                100% {
                    transform: translateY(-50px) scale(0.5);
                    opacity: 0;
                }
            }
            
            .alert-enter {
                animation: slideInRight 0.3s ease-out;
            }
            
            .alert-exit {
                animation: slideOutRight 0.3s ease-in;
            }
            
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Sample food data
        const foodItems = [
            { id: 1, name: "Classic Cheeseburger", description: "Juicy beef patty with cheese, lettuce, and special sauce", price: 8.99, rating: 4.5, image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=999&q=80", restaurant: "Burger King" },
            { id: 2, name: "Pepperoni Pizza", description: "Classic pizza with tomato sauce, mozzarella, and pepperoni", price: 12.99, rating: 4.8, image: "https://images.unsplash.com/photo-1588315029754-2dd089d39a1a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1171&q=80", restaurant: "Pizza Hut" },
            { id: 3, name: "Fried Chicken Bucket", description: "8 pieces of our signature crispy fried chicken", price: 15.99, rating: 4.3, image: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", restaurant: "KFC" },
            { id: 4, name: "Caesar Salad", description: "Fresh romaine lettuce with Caesar dressing, croutons and parmesan", price: 7.99, rating: 4.2, image: "https://images.unsplash.com/photo-1546793665-c74683f339c1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1074&q=80", restaurant: "Healthy Bites" },
            { id: 5, name: "Sushi Combo", description: "Assorted sushi including salmon, tuna and California rolls", price: 18.99, rating: 4.9, image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", restaurant: "Tokyo Sushi" },
            { id: 6, name: "Chocolate Lava Cake", description: "Warm chocolate cake with a molten center, served with ice cream", price: 6.99, rating: 4.7, image: "https://images.unsplash.com/photo-1564355808539-22fda35bed7e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1130&q=80", restaurant: "Sweet Treats" },
            { id: 7, name: "Beef Tacos", description: "Three soft tacos with seasoned beef, lettuce, cheese and salsa", price: 9.99, rating: 4.4, image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1080&q=80", restaurant: "Mexican Fiesta" },
            { id: 8, name: "Pad Thai", description: "Stir-fried rice noodles with eggs, tofu and peanuts", price: 11.99, rating: 4.6, image: "https://images.unsplash.com/photo-1585032226651-759b368d7246?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1092&q=80", restaurant: "Thai Spice" }
        ];

        // Cart functionality
        let cart = [];

        // DOM elements
        const foodItemsContainer = document.getElementById('food-items');
        const cartBtn = document.getElementById('cart-btn');
        const cartDropdown = document.getElementById('cart-dropdown');
        const cartCount = document.getElementById('cart-count');
        const cartItemsContainer = document.getElementById('cart-items');
        const cartTotal = document.getElementById('cart-total');

        // Debug function to check DOM elements
        function checkDOMElements() {
            console.log('DOM Elements check:');
            console.log('- cartBtn:', !!cartBtn);
            console.log('- cartDropdown:', !!cartDropdown);
            console.log('- cartCount:', !!cartCount);
            console.log('- cartItemsContainer:', !!cartItemsContainer);
            console.log('- cartTotal:', !!cartTotal);
            console.log('- checkout button:', !!document.querySelector('.checkout-btn'));
        }

        // Test function to manually add an item (for debugging)
        function testAddToCart() {
            console.log('Testing add to cart...');
            const testItem = {
                id: 999,
                name: "Test Item",
                restaurant: "Test Restaurant",
                price: 100,
                image: "https://via.placeholder.com/100"
            };

            cart.push({ ...testItem, quantity: 1 });
            updateCart();
            console.log('Test item added, cart now:', cart);
        }

        // Function to forcefully reload and sync cart
        function forceReloadCart() {
            console.log('üîÑ Force reloading cart...');
            loadCartFromLocal();
            console.log('üõí Cart after force reload:', cart);
            console.log('üì¶ Cart items count:', cart.length);
        }

        // Sync cart whenever page becomes visible (useful when returning from checkout)
        document.addEventListener('visibilitychange', function () {
            if (!document.hidden) {
                console.log('ÔøΩ Page became visible, syncing cart...');
                const localStorageCart = JSON.parse(localStorage.getItem('cartItems')) || [];
                if (localStorageCart.length > 0 && JSON.stringify(cart) !== JSON.stringify(localStorageCart)) {
                    console.log('üîÑ Cart out of sync, updating...');
                    cart = localStorageCart;
                    updateCart();
                }
            }
        });

        // Also sync cart when window gets focus (browser tab switching)
        window.addEventListener('focus', function () {
            console.log('üéØ Window focused, checking cart sync...');
            const localStorageCart = JSON.parse(localStorage.getItem('cartItems')) || [];
            if (localStorageCart.length > 0 && JSON.stringify(cart) !== JSON.stringify(localStorageCart)) {
                console.log('üîÑ Cart out of sync on focus, updating...');
                cart = localStorageCart;
                updateCart();
            }
        });

        // Function to check cart persistence
        function checkCartPersistence() {
            console.log('=== Cart Persistence Check ===');
            console.log('Current cart variable:', cart);
            console.log('LocalStorage cartItems:', localStorage.getItem('cartItems'));
            console.log('Parsed localStorage:', JSON.parse(localStorage.getItem('cartItems') || '[]'));
            console.log('Cart count element text:', cartCount ? cartCount.textContent : 'Element not found');
            console.log('Cart dropdown is hidden:', cartDropdown ? cartDropdown.classList.contains('hidden') : 'Element not found');
            console.log('Cart items container children:', cartItemsContainer ? cartItemsContainer.children.length : 'Element not found');
            console.log('==============================');
        }

        // Add a function to manually sync cart (useful for debugging)
        function syncCartWithLocalStorage() {
            console.log('üîÑ Manual cart sync requested...');
            const localStorageCart = JSON.parse(localStorage.getItem('cartItems') || '[]');
            console.log('üì¶ LocalStorage cart:', localStorageCart);
            console.log('üõí Current cart:', cart);

            if (JSON.stringify(cart) !== JSON.stringify(localStorageCart)) {
                console.log('‚ö†Ô∏è Cart mismatch detected, syncing...');
                cart = localStorageCart;
                updateCart();
                console.log('‚úÖ Cart synced successfully');
            } else {
                console.log('‚úÖ Cart already in sync');
            }
        }

        // Make test functions available globally for console testing
        window.testAddToCart = testAddToCart;
        window.checkCartPersistence = checkCartPersistence;
        window.forceReloadCart = forceReloadCart;
        window.syncCartWithLocalStorage = syncCartWithLocalStorage;
        const cartPopup = document.getElementById('cart-popup');

        // Render food items
        function renderFoodItems() {
            foodItemsContainer.innerHTML = '';
            foodItems.forEach((item, index) => {
                const foodCard = document.createElement('div');
                foodCard.className = 'food-card bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition duration-300';
                foodCard.style.setProperty('--order', index);

                // Check if this item is already in favorites
                const isFavorite = (typeof cartManager !== 'undefined') ? cartManager.isFavorite(item.id) : false;
                const heartColor = isFavorite ? 'text-red-500' : 'text-gray-400';

                foodCard.innerHTML = `
                    <div class="relative overflow-hidden">
                        <img src="${item.image}" alt="${item.name}" class="w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                        <div class="absolute top-2 right-2 bg-white bg-opacity-90 backdrop-blur-sm p-2 rounded-full cursor-pointer hover:bg-opacity-100 transition-all duration-300 favorite-btn group" data-id="${item.id}">
                            <i class="fas fa-heart ${heartColor} transition-all duration-300 group-hover:scale-110"></i>
                        </div>
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"></div>
                    </div>
                    <div class="p-4 relative">
                        <h3 class="font-bold text-lg mb-2 text-gray-800 line-clamp-1">${item.name}</h3>
                        <p class="text-gray-600 text-sm mb-2 line-clamp-2 leading-relaxed">${item.description}</p>
                        <p class="text-sm text-gray-500 mb-4 flex items-center">
                            <i class="fas fa-store mr-1"></i>
                            ${item.restaurant}
                        </p>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-orange-500 text-lg">‚Çπ${item.price.toFixed(2)}</span>
                            <button class="add-to-cart btn-primary ripple bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl text-sm" data-id="${item.id}">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `;

                foodItemsContainer.appendChild(foodCard);
            });

            // Add event listeners to all "Add to Cart" buttons
            document.querySelectorAll('.add-to-cart').forEach(button => {
                console.log('üéØ Adding event listener to Add to Cart button:', button);
                button.addEventListener('click', function (e) {
                    console.log('üñ±Ô∏è Add to Cart button clicked!');
                    addToCart(e);
                    // Add animation to the clicked button
                    this.classList.add('add-to-cart-animate');
                    setTimeout(() => {
                        this.classList.remove('add-to-cart-animate');
                    }, 500);
                });
            });

            // Add event listeners to favorite buttons with enhanced mobile support
            document.querySelectorAll('.favorite-btn').forEach((button, index) => {
                console.log(`üéØ Adding event listener to favorite button ${index + 1}:`, button);
                
                // Add a simple test click first
                button.style.cursor = 'pointer';
                button.style.pointerEvents = 'auto';
                
                button.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('‚ù§Ô∏è HEART CLICKED! Button:', this);
                    console.log('‚ù§Ô∏è Event object:', e);
                    
                    // Simple visual feedback first
                    const icon = this.querySelector('i');
                    console.log('üéØ Icon found:', icon);
                    
                    if (!icon) {
                        console.error('‚ùå No icon found in button!');
                        return;
                    }
                    
                    // Basic color toggle test
                    if (icon.classList.contains('text-gray-400')) {
                        icon.classList.remove('text-gray-400');
                        icon.classList.add('text-red-500');
                        alert('Heart added to favorites! ‚ù§Ô∏è');
                    } else {
                        icon.classList.remove('text-red-500');
                        icon.classList.add('text-gray-400');
                        alert('Heart removed from favorites! üíî');
                    }
                    
                    // Now try the advanced functionality if cartManager exists
                    if (typeof cartManager === 'undefined') {
                        console.error('‚ùå cartManager is not available!');
                        return;
                    }
                    
                    const itemId = parseInt(this.getAttribute('data-id'));
                    console.log('üìã Item ID:', itemId);
                    const item = foodItems.find(item => item.id === itemId);
                    
                    if (!item) {
                        console.error('‚ùå Item not found for ID:', itemId);
                        return;
                    }

                    console.log('üçΩÔ∏è Found item:', item);
                    
                    // Toggle favorite status
                    const isNowFavorite = cartManager.toggleFavorite(item);
                    console.log('üíñ Is now favorite:', isNowFavorite);
                    
                    // Show success message
                    if (isNowFavorite) {
                        showAlert(`${item.name} added to favorites! ‚ù§Ô∏è`, 'success');
                    } else {
                        showAlert(`${item.name} removed from favorites`, 'info');
                    }
                });
                
                console.log(`‚úÖ Event listener added to button ${index + 1}`);
            });
            
            console.log(`üéØ Total favorite buttons found: ${document.querySelectorAll('.favorite-btn').length}`);
        }

        // Add item to cart
        function addToCart(e) {
            console.log('üõí Add to cart function called!', e.target);
            const id = parseInt(e.target.getAttribute('data-id'));
            console.log('Item ID:', id);
            const item = foodItems.find(item => item.id === id);

            if (!item) {
                console.error('Item not found:', id);
                showAlert('Item not found!', 'error');
                return;
            }

            // Check if item already exists in cart
            const existingItem = cart.find(cartItem => cartItem.id === id);

            if (existingItem) {
                existingItem.quantity += 1;
                showAlert(`Added another ${item.name} to cart!`, 'success');
            } else {
                cart.push({ ...item, quantity: 1 });
                showAlert(`${item.name} added to cart!`, 'success');
            }

            updateCart();

            // Simple cart button animation
            const button = e.target.closest('button');
            if (button) {
                button.classList.add('pulse');

                // Simple haptic feedback for mobile devices
                if (navigator.vibrate) {
                    navigator.vibrate(25);
                }

                setTimeout(() => {
                    button.classList.remove('pulse');
                }, 500);
            }

            // Animate cart icon in header
            if (cartBtn) {
                cartBtn.classList.add('pulse');
                setTimeout(() => {
                    cartBtn.classList.remove('pulse');
                }, 1000);
            }
        }

        // Remove item from cart
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCart();
        }

        // Update cart quantity
        function updateCartQuantity(id, quantity) {
            const item = cart.find(item => item.id === id);
            if (item) {
                item.quantity = quantity;
                if (item.quantity <= 0) {
                    removeFromCart(id);
                } else {
                    updateCart();
                }
            }
        }

        // Save/load cart from localStorage for guests
        function saveCartToLocal() {
            console.log('Saving cart to localStorage:', cart);
            localStorage.setItem('cartItems', JSON.stringify(cart));
        }

        function loadCartFromLocal() {
            const savedCart = JSON.parse(localStorage.getItem('cartItems')) || [];
            console.log('Loading cart from localStorage:', savedCart);
            cart = savedCart;
            // Use updateCart() instead of updateCartDisplay() to properly render cart items
            updateCart();
        }

        // Clear cart function
        function clearCart() {
            cart = [];
            localStorage.removeItem('cartItems');
            updateCart();
        }

        // Validate cart function
        function validateCart() {
            // Ensure cart is synced with localStorage
            const localStorageItems = JSON.parse(localStorage.getItem('cartItems') || '[]');

            if (cart.length === 0 && localStorageItems.length > 0) {
                console.log('‚ö†Ô∏è Cart mismatch detected, syncing...');
                cart = localStorageItems;
                updateCartDisplay();
            }

            return cart.length > 0 || localStorageItems.length > 0;
        }

        // Get total cart value
        function getCartTotal() {
            return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
        }

        // Get total items count
        function getCartItemsCount() {
            return cart.reduce((count, item) => count + item.quantity, 0);
        }

        // Update cart UI
        function updateCart() {
            console.log('Updating cart UI, cart:', cart);
            // Update cart count
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            console.log('Total items:', totalItems);

            if (cartCount) {
                cartCount.textContent = totalItems;
                console.log('Updated cart count display to:', totalItems);
            } else {
                console.error('cartCount element not found!');
            }

            // Update cart items
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = `
                    <div class="p-8 text-center text-gray-500">
                        <div class="mb-4">
                            <i class="fas fa-shopping-cart text-6xl text-gray-300"></i>
                        </div>
                        <p class="text-lg font-medium mb-2 text-gray-600">Your cart is empty</p>
                        <p class="text-sm text-gray-400">Add delicious items to get started!</p>
                        <div class="mt-4">
                            <button onclick="document.getElementById('cart-dropdown').classList.add('hidden')" 
                                    class="px-6 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-300 text-sm font-semibold">
                                Browse Menu
                            </button>
                        </div>
                    </div>
                `;
                if (cartTotal) cartTotal.textContent = '‚Çπ0.00';
            } else {
                cartItemsContainer.innerHTML = '';
                let total = 0;

                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;

                    const cartItem = document.createElement('div');
                    cartItem.className = 'flex items-center py-3 px-2 border-b border-gray-100';
                    cartItem.innerHTML = `
                        <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded-lg mr-3">
                        <div class="flex-grow">
                            <h4 class="font-medium text-gray-800">${item.name}</h4>
                            <p class="text-sm text-gray-500">‚Çπ${item.price.toFixed(2)} each</p>
                        </div>
                        <div class="flex items-center bg-gray-100 rounded-lg p-1">
                            <button class="quantity-btn decrease w-8 h-8 bg-orange-500 text-white rounded-lg flex items-center justify-center hover:bg-orange-600 transition duration-300 font-bold" data-id="${item.id}">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <span class="mx-3 w-8 text-center font-semibold text-gray-800">${item.quantity}</span>
                            <button class="quantity-btn increase w-8 h-8 bg-orange-500 text-white rounded-lg flex items-center justify-center hover:bg-orange-600 transition duration-300 font-bold" data-id="${item.id}">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                        </div>
                    `;

                    cartItemsContainer.appendChild(cartItem);
                });

                cartTotal.textContent = `‚Çπ${total.toFixed(2)}`;

                // Update the total section to show item count
                const totalSection = cartTotal.parentElement;
                if (totalSection) {
                    const itemCount = cart.reduce((count, item) => count + item.quantity, 0);
                    totalSection.innerHTML = `
                        <div class="text-center mb-2">
                            <span class="text-sm text-gray-500">${itemCount} item${itemCount !== 1 ? 's' : ''} in cart</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-gray-700 text-lg">Total:</span>
                            <span id="cart-total" class="font-bold text-2xl text-orange-600">‚Çπ${total.toFixed(2)}</span>
                        </div>
                    `;
                }

                // Add event listeners for quantity buttons in cart dropdown
                document.querySelectorAll('.quantity-btn.decrease').forEach(btn => {
                    btn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        const id = parseInt(this.getAttribute('data-id'));
                        const item = cart.find(item => item.id === id);
                        if (item) {
                            item.quantity -= 1;
                            // If quantity becomes 0, remove the item completely
                            if (item.quantity <= 0) {
                                cart = cart.filter(cartItem => cartItem.id !== id);
                                showAlert('Item removed from cart', 'info', 1000);
                            }
                            updateCart();
                            
                            // Add visual feedback
                            this.classList.add('scale-110');
                            setTimeout(() => {
                                this.classList.remove('scale-110');
                            }, 150);
                            
                            // Haptic feedback
                            if (navigator.vibrate) {
                                navigator.vibrate(25);
                            }
                        }
                    });
                });

                document.querySelectorAll('.quantity-btn.increase').forEach(btn => {
                    btn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        const id = parseInt(this.getAttribute('data-id'));
                        const item = cart.find(item => item.id === id);
                        if (item) {
                            item.quantity += 1;
                            updateCart();
                            
                            // Add visual feedback
                            this.classList.add('scale-110');
                            setTimeout(() => {
                                this.classList.remove('scale-110');
                            }, 150);
                            
                            // Haptic feedback
                            if (navigator.vibrate) {
                                navigator.vibrate(25);
                            }
                        }
                    });
                });
            }

            // Save to localStorage and also update display counter
            saveCartToLocal();
            updateCartDisplay();
        }

        // Update cart display elements
        function updateCartDisplay() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            console.log('Updating cart display, total items:', totalItems);

            if (cartCount) {
                cartCount.textContent = totalItems;
                console.log('Cart count updated to:', totalItems);
            } else {
                console.error('Cart count element not found!');
            }
        }

        // Toggle cart dropdown
        cartBtn.addEventListener('click', function (e) {
            e.stopPropagation();

            // Always sync cart with localStorage before showing dropdown
            const localStorageCart = JSON.parse(localStorage.getItem('cartItems')) || [];
            if (localStorageCart.length > 0 && cart.length === 0) {
                console.log('üîÑ Syncing cart with localStorage on dropdown open');
                cart = localStorageCart;
                updateCart();
            }

            cartDropdown.classList.toggle('hidden');
        });        // Close cart dropdown when clicking outside
        document.addEventListener('click', function (e) {
            if (!cartDropdown.contains(e.target) && !cartBtn.contains(e.target)) {
                cartDropdown.classList.add('hidden');
            }
        });

        // Prevent cart dropdown from closing when clicking inside it
        cartDropdown.addEventListener('click', function (e) {
            e.stopPropagation();
        });

        // Enhanced alert function with better animations
        function showAlert(message, type = 'info', duration = 1500) {
            const alertDiv = document.createElement('div');
            const bgColor = {
                'success': 'bg-gradient-to-r from-green-500 to-green-600',
                'error': 'bg-gradient-to-r from-red-500 to-red-600',
                'warning': 'bg-gradient-to-r from-yellow-500 to-yellow-600',
                'info': 'bg-gradient-to-r from-blue-500 to-blue-600'
            }[type] || 'bg-gradient-to-r from-blue-500 to-blue-600';

            const icon = {
                'success': 'fa-check-circle',
                'error': 'fa-times-circle',
                'warning': 'fa-exclamation-triangle',
                'info': 'fa-info-circle'
            }[type] || 'fa-info-circle';

            alertDiv.className = `fixed top-4 right-4 px-4 py-3 rounded-xl shadow-2xl z-50 text-white transition-all duration-300 transform translate-x-full ${bgColor} alert-enter backdrop-blur-sm max-w-xs`;
            alertDiv.innerHTML = `
                <div class="flex items-center space-x-2">
                    <div class="flex-shrink-0">
                        <i class="fas ${icon} text-lg"></i>
                    </div>
                    <div class="flex-1">
                        <p class="font-medium text-sm">${message}</p>
                    </div>
                </div>
                <div class="absolute bottom-0 left-0 h-1 bg-white bg-opacity-30 rounded-full transition-all" style="width: 100%; animation: progressBar ${duration}ms linear;"></div>
            `;

            // Add progress bar animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes progressBar {
                    from { width: 100%; }
                    to { width: 0%; }
                }
            `;
            document.head.appendChild(style);

            document.body.appendChild(alertDiv);

            // Slide in with enhanced animation
            setTimeout(() => {
                alertDiv.classList.remove('translate-x-full');
                alertDiv.classList.add('translate-x-0');
            }, 100);

            // Auto remove with enhanced animation
            setTimeout(() => {
                alertDiv.classList.add('alert-exit');
                alertDiv.classList.remove('alert-enter');
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.remove();
                        style.remove();
                    }
                }, 300);
            }, duration);

            // Add click to dismiss
            alertDiv.addEventListener('click', () => {
                alertDiv.classList.add('alert-exit');
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.remove();
                        style.remove();
                    }
                }, 300);
            });
        }

        // Utility to check login status
        function isLoggedIn() {
            const hasToken = !!localStorage.getItem('token');
            console.log('Login check - hasToken:', hasToken);
            return hasToken;
        }

        // Update UI based on login status
        function updateUIForLoginStatus() {
            const profileIconContainer = document.getElementById('profile-icon-container');
            const notificationsContainer = document.getElementById('notifications-container');
            const userCta = document.getElementById('user-cta');
            const welcomeUserName = document.getElementById('welcome-user-name');

            if (isLoggedIn()) {
                // Keep profile icon visible and show other logged-in elements
                if (profileIconContainer) profileIconContainer.classList.remove('hidden');
                if (notificationsContainer) notificationsContainer.classList.remove('hidden');

                // Update welcome banner
                if (userCta) userCta.classList.remove('hidden');

                // Update user info
                const username = localStorage.getItem('username') || 'User';
                const email = localStorage.getItem('userEmail') || 'user@example.com';

                const userName = document.getElementById('user-name');
                const avatar = document.getElementById('user-avatar');

                if (userName) userName.textContent = username;
                if (welcomeUserName) welcomeUserName.textContent = `Welcome back, ${username}!`;

                // Set user avatar to first letter of username
                if (avatar) avatar.textContent = username.charAt(0).toUpperCase();

                // Reload cart after login
                console.log('üîÑ Reloading cart after login status update...');
                forceReloadCart();
            } else {
                // Show profile icon for login, hide other logged-in elements
                if (profileIconContainer) profileIconContainer.classList.remove('hidden');
                if (notificationsContainer) notificationsContainer.classList.add('hidden');

                // Update welcome banner
                if (userCta) userCta.classList.add('hidden');
            }
        }

        // Show/hide modals
        function showLogin() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('registerModal').classList.add('hidden');
        }
        function showRegister() {
            document.getElementById('registerModal').classList.remove('hidden');
            document.getElementById('loginModal').classList.add('hidden');
        }
        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }

        // Register
        async function register() {
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            // Step 1: Send OTP
            const res = await fetch('/api/auth/send-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email })
            });
            const data = await res.json();
            if (res.ok) {
                // Prompt user for OTP (and username if needed)
                const otp = prompt('Enter the OTP sent to your email:');
                // Step 2: Verify OTP and set username
                const verifyRes = await fetch('/api/auth/verify-otp', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, otp, username })
                });
                const verifyData = await verifyRes.json();
                if (verifyRes.ok && verifyData.token) {
                    localStorage.setItem('token', verifyData.token);
                    localStorage.setItem('userId', verifyData.userId);
                    localStorage.setItem('username', verifyData.username);
                    closeModal('registerModal');
                    alert('Registration successful!');
                    updateUIForLoginStatus();
                } else {
                    alert(verifyData.message || 'OTP verification failed.');
                }
            } else {
                alert(data.message || 'Failed to send OTP.');
            }
        }

        // Complete Registration
        async function completeRegistration() {
            const email = document.getElementById('registerEmail').value;
            const username = document.getElementById('newUsername').value;
            const mobile = document.getElementById('newMobile').value;
            const res = await fetch('/api/auth/complete-registration', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, username, mobile })
            });
            const data = await res.json();
            if (res.ok && data.token) {
                localStorage.setItem('token', data.token);
                window.location.href = '/';
            } else {
                alert(data.error || 'Registration failed');
            }
        }

        // Login
        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const res = await fetch('/api/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });
            if (res.ok) {
                const data = await res.json();
                localStorage.setItem('token', data.token);
                localStorage.setItem('userId', data.userId);
                localStorage.setItem('username', data.username);
                closeModal('loginModal');
                alert('Login successful!');
                updateUIForLoginStatus();
            } else {
                alert('Login failed.');
            }
        }

        // Logout function
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('userId');
            localStorage.removeItem('username');
            updateUIForLoginStatus();
            alert('Logged out!');
        }

        // On page load
        window.onload = function () {
            console.log('üåç Page loaded, initializing...');
            console.log('üóÑÔ∏è LocalStorage cartItems on load:', localStorage.getItem('cartItems'));

            checkDOMElements();

            // Delay cart loading to ensure DOM is ready
            setTimeout(() => {
                console.log('‚è∞ Delayed initialization starting...');
                updateUIForLoginStatus();

                // Force reload cart to ensure synchronization
                forceReloadCart();

                console.log('‚úÖ Initialization complete');
                console.log('üõí Cart after loading:', cart);
                console.log('üì¶ Cart length:', cart.length);
                console.log('üíæ LocalStorage cartItems parsed:', JSON.parse(localStorage.getItem('cartItems') || '[]'));
            }, 100);

            // Profile icon click event
            const profileBtn = document.getElementById('profile-btn');
            if (profileBtn) {
                profileBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('Profile button clicked, logged in:', isLoggedIn());
                    if (!isLoggedIn()) {
                        // Store the return URL for after login
                        localStorage.setItem('returnUrl', 'index.html');
                        window.location.href = 'login.html';
                    } else {
                        // Redirect to profile page when logged in
                        window.location.href = 'profile.html';
                    }
                });
            }

            // Checkout button click event
            const checkoutBtn = document.querySelector('.checkout-btn');
            console.log('Checkout button element found:', !!checkoutBtn);
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('üñ±Ô∏è Checkout button clicked');

                    // Validate cart using the new validation function
                    if (!validateCart()) {
                        console.log('Cart is empty, showing warning');
                        showAlert('Your cart is empty! Please add some items first.', 'warning');
                        return;
                    }

                    console.log('Cart has items, checking login status:', isLoggedIn());

                    if (!isLoggedIn()) {
                        console.log('User not logged in, storing return URL and redirecting to login');
                        // Store the return URL for after login
                        localStorage.setItem('returnUrl', 'checkout.html');
                        showAlert('Please login to proceed with checkout', 'info');
                        setTimeout(() => {
                            window.location.href = 'login.html';
                        }, 1000);
                        return;
                    }

                    console.log('User is logged in, redirecting to checkout');
                    // Redirect to checkout page
                    setTimeout(() => {
                        window.location.href = 'checkout.html';
                    }, 500);
                });
            } else {
                console.error('Checkout button not found! Check if the .checkout-btn selector is correct.');
            }

            // If you have a login icon button
            const loginIconBtn = document.getElementById('loginIconBtn');
            if (loginIconBtn) {
                loginIconBtn.addEventListener('click', showLogin);
            }

            // Menu button event listener
            const menuBtn = document.getElementById('menu-btn');
            if (menuBtn) {
                menuBtn.addEventListener('click', function () {
                    // Menu button could scroll to menu section or show food categories
                    // For now, let's scroll to the food section
                    const foodSection = document.querySelector('#food-section') || document.querySelector('.food-card');
                    if (foodSection) {
                        foodSection.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            }
        };

        // Mock data for testing (uncomment to add sample items to cart)
        function addMockCartData() {
            const mockItems = [
                {
                    id: 1,
                    name: "Butter Chicken",
                    restaurant: "Spice Palace",
                    price: 280,
                    quantity: 2,
                    image: "https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=100&h=100&fit=crop"
                },
                {
                    id: 2,
                    name: "Margherita Pizza",
                    restaurant: "Pizza Corner",
                    price: 320,
                    quantity: 1,
                    image: "https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?w=100&h=100&fit=crop"
                }
            ];
            localStorage.setItem('cartItems', JSON.stringify(mockItems));
            updateCartDisplay();
        }

        // Initialize the app
        function initializeApp() {
            console.log('üöÄ Initializing VitalBites app...');

            // Check if cartManager is available
            if (typeof cartManager !== 'undefined') {
                console.log('‚úÖ cartManager is available:', cartManager);
            } else {
                console.error('‚ùå cartManager is not available during initialization!');
            }

            // Render food items first
            renderFoodItems();

            // Load cart from localStorage if available
            loadCartFromLocal();

            // Update UI based on login status
            updateUIForLoginStatus();

            console.log('‚úÖ App initialized successfully');
        }

        // Call initialization
        initializeApp();

        // Add a manual cart refresh function for debugging
        window.refreshCart = function () {
            console.log('üîÑ Manual cart refresh triggered');
            forceReloadCart();
        };

        // Make cart functions available globally for debugging
        window.cart = cart;
        window.clearCart = clearCart;
        window.validateCart = validateCart;
        window.getCartTotal = getCartTotal;
        window.getCartItemsCount = getCartItemsCount;
        window.syncCartWithLocalStorage = syncCartWithLocalStorage;
        window.checkCartPersistence = checkCartPersistence;

        // Add hover effect to restaurant cards
        document.querySelectorAll('.restaurant-card').forEach(card => {
            card.addEventListener('mouseenter', function () {
                this.style.transform = 'translateY(-5px)';
                this.style.boxShadow = '0 10px 25px -5px rgba(0, 0, 0, 0.1)';
            });

            card.addEventListener('mouseleave', function () {
                this.style.transform = '';
                this.style.boxShadow = '';
            });
        });

        // Clean up and remove redundant code sections

        // Event listeners for login and menu buttons (if they exist)
        const loginBtn = document.getElementById('loginBtn');
        const loginIconBtn = document.getElementById('loginIconBtn');
        const menuBtn = document.getElementById('menu-btn');

        if (loginBtn) {
            loginBtn.addEventListener('click', showLogin);
        }

        if (loginIconBtn) {
            loginIconBtn.addEventListener('click', showLogin);
        }

        if (menuBtn) {
            menuBtn.addEventListener('click', function () {
                const foodSection = document.querySelector('#food-section') || document.querySelector('.food-card');
                if (foodSection) {
                    foodSection.scrollIntoView({ behavior: 'smooth' });
                }
            });
        }
    </script>
</body>

</html>